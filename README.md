# Cyberpunk 2027 Hubs - SillyTavern 主题扩展

[![Version](https://img.shields.io/badge/version-1.0-blue)](https://github.com/your-repo/cyberpunk2027-hubs)
[![SillyTavern](https://img.shields.io/badge/SillyTavern-Compatible-green)](https://sillytavernai.com/)
[![License](https://img.shields.io/badge/license-MIT-blue)](LICENSE)

一个全功能的 SillyTavern 主题扩展，提供沉浸式的赛博朋克 2027 体验，包含多种布局、视觉样式、动态背景和聊天模板系统。

## ✨ 核心功能

### 🎨 主题系统
- **霓虹灯黑色 (Neon Noir)**: 经典赛博朋克风格，霓虹灯效果和深色背景
- **锈蚀铬合金 (Rust Chrome)**: 工业风格，金属质感和锈蚀效果
- **可自定义配置**: 模糊强度、阴影宽度、字体缩放等参数调节

### 🖥️ 界面布局
- **Decker's Dream**: 增强默认布局，保持熟悉的操作体验
- **Tyrell Cockpit**: 垂直导航布局，配备动态角色背景系统

### 🎭 聊天样式
- **Matrix Terminal**: 绿色终端风格，经典黑客美学
- **Neural Holographic**: 全息神经网络风格，未来科技感

### 🌟 动态背景系统

#### 角色背景 (Tyrell 布局专用)
- 自动根据当前对话角色显示对应头像背景
- 支持平滑淡入淡出过渡效果
- 智能检测聊天状态，主页时自动隐藏

#### AI 生成背景
- **智能环境分析**: 基于对话内容自动分析场景环境
- **自动生成**: 根据环境描述生成相应的背景图像
- **缓存系统**: 智能缓存已生成的背景，避免重复生成
- **手动生成**: 提供浮动按钮支持手动触发生成
- **资源管理**: 内置工具扫描和清理未使用的背景图像

#### 视频背景
- 主页显示动态视频背景，营造沉浸式体验
- 支持循环播放控制
- 聊天时自动隐藏以节省性能

### 📝 模板渲染系统

#### 支持的模块
- **Scene Container (场景容器)**: 渲染场景描述和环境信息
- **Combat Interface (战斗界面)**: 显示战斗状态和技能信息
- **Inventory Check (库存检查)**: 物品和装备展示
- **Character Status (角色状态)**: 角色属性和状态显示
- **Dialogue Panel (对话面板)**: 特殊对话格式
- **Map Display (地图显示)**: 地理位置和导航信息

#### 主题支持
- **Cyberpunk**: 赛博朋克 2077 风格模板
- **AI Warrior**: 未来机械战士主题模板
- **动态配置**: 支持从配置文件动态加载主题和模块

## 🚀 快速开始

### 安装
1. 将扩展文件夹放置到 SillyTavern 的 `public/scripts/extensions/` 目录下
2. 重启 SillyTavern 或刷新页面
3. 在扩展设置中找到 "Cyberpunk 2027 Hubs" 并启用

### 基本使用
1. **启用主题**: 勾选 "启用 Cyberpunk 2027 主题"
2. **选择布局**: 从 "界面布局" 下拉菜单中选择布局
3. **选择样式**: 从 "视觉风格" 中选择颜色方案
4. **配置功能**: 根据需要启用各种功能模块

## 🛠️ 详细配置

### 主题配置
- **模糊强度**: 调节界面模糊效果 (0-50px)
- **阴影宽度**: 控制元素阴影大小 (0-10px)
- **字体缩放**: 调整整体字体大小 (0.5-2.0)
- **重置按钮**: 一键恢复主题默认设置

### AI 背景配置
- **自动生成**: 根据消息数量自动触发背景生成
- **触发间隔**: 设置每隔多少条消息触发一次 (1-50条)
- **图像尺寸**: 自定义生成图像的宽度和高度
- **缓存管理**: 设置缓存数量限制和过期天数

### 模板渲染配置
- **启用渲染**: 开启聊天模板系统
- **主题选择**: 选择模板主题风格
- **模块管理**: 按需启用/禁用特定模块类型

## 💡 使用示例

### 聊天模板使用
在聊天消息中使用以下格式来触发模板渲染：

```html
<span data-type="scene-container" 
      data-location="夜之城中央区" 
      data-time="2077年深夜" 
      data-weather="霓虹灯闪烁的雨夜" 
      data-atmosphere="紧张刺激">
</span>
```

### AI 背景生成
1. 启用 "AI 生成背景" 功能
2. 开启 "自动生成" 或使用手动生成按钮
3. 系统会分析对话内容并生成相应背景
4. 生成的背景会自动缓存，避免重复生成

## 🔧 高级功能

### 资源管理
- **扫描工具**: 自动扫描所有 AI 生成的背景图像
- **使用分析**: 识别已使用和未使用的图像文件
- **批量清理**: 一键删除未使用的背景文件
- **存储优化**: 显示可释放的存储空间大小

### 事件集成
扩展深度集成 SillyTavern 的事件系统：
- 消息接收时自动处理模板
- 聊天切换时更新背景
- 角色变更时切换角色背景
- 消息编辑时重新渲染模板

## 🎯 兼容性

### 系统要求
- SillyTavern 最新版本
- 现代浏览器 (Chrome 88+, Firefox 85+, Safari 14+)
- 支持 ES6+ 语法的 JavaScript 环境

### 功能依赖
- **AI 背景生成**: 需要配置图像生成 API
- **视频背景**: 需要浏览器支持 HTML5 video
- **模板渲染**: 依赖 SillyTavern 扩展系统

## 🐛 故障排除

### 常见问题
1. **主题未生效**: 检查是否正确启用了扩展
2. **背景不显示**: 确认 Tyrell 布局和角色背景功能已启用
3. **AI 背景失败**: 验证图像生成 API 配置
4. **模板未渲染**: 确认模板渲染功能已启用且语法正确

### 调试信息
扩展在浏览器控制台中提供详细的调试日志，所有日志都以 `[cyberpunk2027-hubs]` 为前缀。

## 📈 性能优化

### 自动优化
- **智能缓存**: 模板和配置文件自动缓存
- **按需加载**: CSS 和 HTML 文件按需加载
- **防重复处理**: 内置防重复渲染机制
- **资源清理**: 主题切换时自动清理无用资源

### 性能建议
- 定期使用资源管理工具清理未使用的背景
- 合理设置 AI 背景触发间隔
- 禁用不需要的功能模块以提升性能

## 🔄 更新日志

### v1.0.0
- ✨ 初始版本发布
- 🎨 支持双主题双布局系统
- 🌟 集成动态背景系统
- 📝 完整的模板渲染功能
- 🛠️ 资源管理和优化工具

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request！

### 开发设置
1. Fork 项目仓库
2. 创建功能分支 (`git checkout -b feature/amazing-feature`)
3. 提交更改 (`git commit -m 'Add some amazing feature'`)
4. 推送到分支 (`git push origin feature/amazing-feature`)
5. 创建 Pull Request

## 📜 许可证

该项目基于 MIT 许可证开源。详情请查看 [LICENSE](LICENSE) 文件。

## 🙏 致谢

- SillyTavern 开发团队提供的优秀平台
- 赛博朋克 2077 提供的视觉灵感
- 所有贡献者和用户的支持

---

**Enjoy your cyberpunk adventure! 🌃**